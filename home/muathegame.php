<? include("config.php") ?>
<!DOCTYPE html>
<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Mua thẻ game online giá rẻ, mua thẻ Garena, Gate, Zing, Voin</title>
    <meta name="description" content='Đăng ký tài khoản miễn phí mua thẻ game chiết khấu cao tại Banthe24h.vn, mua thẻ Garena, Gate, Zing, Vcoin trực tuyến đơn giản và nhanh chóng nhất. Mau card ngay!' />
    <meta name="keywords" content='mua thẻ game, mua thẻ cào game, mua mã thẻ game, mua thẻ game online, mua thẻ game trực tuyến' />
    <meta name="robots" content='noodp,index,follow' />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <meta name='revisit-after' content='1 days' />
    <meta http-equiv="content-language" content="vi" />
    <meta name="author" itemprop="author" content="banthe24h.vn" />
    <meta name="google-site-verification" content="BiFRC7mAFeY-M7x3tM-xwZQKhNIrDVkBgahKnZrEplU" />
    <link rel="canonical" href='https://banthe24h.vn/tien-ich/mua-the-game' />
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link media="screen" rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.4.0/css/font-awesome.css" />
    <link rel="stylesheet" type="text/css" href="/css/style.min2.css?v=<?= $ver; ?>" />
    <link rel="stylesheet" type="text/css" href="/css/responsive.css?v=<?= $ver; ?>" />
    <script src="/js/jquery.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <script src="/js/common.js"></script>
    <script src="/js/usermanager.js"></script>
</head>

<body style="cursor: pointer !important;">
    <!--header section work start-->


    <? include ("../includes/inc_header.php")?>
    <div id="slideout">
        <img src="/images/phone.png" alt="hotline banthe24h.vn">
        <div id="slideout_inner">
            <div style="color:#fd0000">Hotline:</div>
            <span><b>1900 633682</b></span>
            <div style="color:#fd0000">Email:</div>
            <span><b>info@24hpay.vn</b></span>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="divcontent1 divmuathe">
                <h1 class="section-title bg-lable2" style="font-size: 22px;text-transform: uppercase;"><span>Mua thẻ game online</span></h1>
                <div class="form-content bg1 col-md-4" style="border : none">
                    <form name="buycard" action="#" method="post">
                        <div class="form-group">
                            <div class="boxdrpmega">
                                <table rel="" style="margin-top:0px!important;" width="100%">
                                    <tr>
                                        <td id="trproviderdt">
                                            <select id="ProviderIdDT" class="form-control">
                                                <option value="">Chọn loại thẻ game</option>
                                                <option value="5">FPT</option>
                                                <option value="12">ZING</option>
                                                <option value="14">GAR</option>
                                                <option value="13">VTC</option>
                                                <option value="17">BIT</option>
                                                <option value="23">Mobi Data</option>
                                                <option value="24">Bitdefender</option>
                                                <option value="25">Kaspersky Anti</option>
                                                <option value="26">Kaspersky Internet</option>
                                            </select>
                                        </td>
                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="form-group">
                            <div class="boxdrpmega">
                                <table rel="" width="100%">
                                    <tr>
                                        <td id="tbl_CardAmount">
                                            <select id="optCardAmount" class="form-control">
                                                <option value="0">Mệnh giá thẻ nạp</option>
                                            </select>
                                        </td>

                                    </tr>
                                </table>
                            </div>
                        </div>
                        <div class="form-group">
                            <table rel="" width="100%">
                                <tr>
                                    <td>
                                        <input class="form-control" type="text" maxlength="40" autocomplete="off" id="ctrlsoluongthedt" name="ctrlsoluongthedt" value="" placeholder="Số lượng thẻ cần mua" title="Số lượng thẻ" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="form-group">
                            <table rel="" width="100%">
                                <tr>
                                    <td>
                                        <div class="boxdrpmega">
                                            <select id="thedtPaymentMethod" class="form-control" tabindex="5">
                                                <option value="">Phương thức thanh toán</option>
                                                <option selected="selected" value="BANTHE24H">Ví Banthe24h</option>
                                                <!-- <option value="VIETCOMBANK">Vietcombank</option>
                                                                    <option value="VIETINBANK">Vietinbank</option>
                                                                    <option value="DONGABANK">Đông Á Bank</option>
                                                                    <option value="SACOMBANK">Sacombank</option>
                                                                    <option value="BIDV">BIDV</option>
                                                                    <option value="MSBANK">Maritimebank</option>
                                                                    <option value="OJB">Ocean Bank</option>
                                                                    <option value="TECHCOMBANK">Techcombank</option>
                                                                    <option value="NAMABANK">Nam Á Bank</option>
                                                                    <option value="HDBANK">HD Bank</option>
                                                                    <option value="VISA">VnMart</option>
                                                                    <option value="TPBANK">Tiên Phong Bank</option> -->
                                            </select>
                                        </div>
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="form-group ctrlmuathedtemail" style="">
                            <table rel="" width="100%">
                                <tr>
                                    <td>
                                        <input class="form-control" type="email" id="ctrlmuathedtemail" autocomplete="off" name="ctrlmuathedtemail" value="" placeholder="Địa chỉ email nhận mã thẻ" title="" />
                                    </td>
                                </tr>
                            </table>
                        </div>
                        <div class="form-group divbt" style="bottom: inherit !important;">

                            <button type="button" class="btn btn-spec1 btn-md btn-block" id="ctrlmuathedtbtn" style="width:100%;">Mua thẻ ngay</button>

                        </div>
                </div>
                <div class="col-md-8 bg1 form-content" style="border:none">
                    <div id="thongtingiaodich">
                        <div style="font-weight:bold;text-transform:uppercase;font-size:18px;padding-bottom:8px;">Thông tin giao dịch</div>
                        <div>
                            <label class="control-label bold">* Sử dụng tài khoản thành viên để nhận được chiết khấu cao nhất
                                <pre style="color:#ff0000;">FPT, VTC, ZING là 3.5%</pre></label>
                            <label class="control-label bold">* Thanh toán qua tài khoản ví Banthe24h:
                                <pre style="color:#ff0000;">Nhanh, tiện lợi và miễn phí giao dịch</pre></label>
                            <label class="control-label bold">* Đăng ký tài khoản:
                                <pre style="color:#ff0000;">Miễn phí</pre></label>
                        </div>
                    </div>
                    <div id="thedtpreviewmodal" style="display: none;" tabindex="-1" role="dialog" aria-labelledby="myModalLabelthedt" aria-hidden="true">
                        <div class="">
                            <div class="">
                                <div class="">
                                    <h4 class="modal-title" id="myModalLabelthedt"><i class="fa fa-caret-square-o-right"></i>Thông tin giao dịch</h4>
                                </div>
                                <form class="form-horizontal" role="form">
                                    <div class="panel-body">
                                        <div class="row form-horizontal">
                                            <div class="col-sm-12">
                                                <label class="control-label col-sm-4">Nhà cung cấp:</label>
                                                <div class="col-sm-7">
                                                    <label class="txtcon" id="lblprovider"></label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <label class="control-label col-sm-4">Mệnh giá:</label>
                                                <div class="col-sm-7">
                                                    <label class="txtcon" id="lblcardtype"></label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <label class="control-label col-sm-4">Số lượng:</label>
                                                <div class="col-sm-7">
                                                    <label class="txtcon" id="lblsoluongthe"></label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12">
                                                <label class="control-label col-sm-4">Thành tiền:</label>
                                                <div class="col-sm-8">
                                                    <label class="txtcon" id="lblsotien"></label>
                                                </div>
                                            </div>
                                            <div class="col-sm-12 thongtinemailnhan">
                                                <label class="control-label col-sm-4">Email nhận:</label>
                                                <div class="col-sm-7">
                                                    <label class="txtcon" id="lblemail"></label>
                                                </div>
                                            </div>

                                        </div>
                                        <div class="row" id="Confirm_OrderDetail">

                                        </div>
                                    </div>
                                    <div class="text-center">
                                        <button type="button" class="btn btn-primary" id="ctrthanhtoanthedt" tabindex="1"><i class="fa fa-sign-in"></i> Thanh toán ngay</button>
                                        <button type="button" class="btn btn-default" id="ctrlhuygiaodich" tabindex="2"><i class="fa fa-times"></i>Hủy giao dịch</button>
                                        <div class="clearfix"></div>
                                    </div>

                                </form>
                            </div>
                        </div>
                    </div>
                </div>
                </form>
            </div>
            <div class="noidungtrangchu">
                <div class="">
                    <? include("../includes/home/inc_linktuychon2.php") ?>
                </div>
            </div>
        </div>
    </div>
    <? include ("../includes/inc_footer.php")?>
    <div class="modal fade" id="thedtshowresultmodal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <h4 class="modal-title" id="myModalLabel"><i class="fa fa-caret-square-o-right"></i>Thông báo giao dịch mua mã thẻ</h4>
                </div>
                <form class="form-horizontal" role="form">
                    <div class="panel-body">
                        <div class="">
                            <div id="notifyresult" class="alertx">
                                <i class="fa sign"></i><strong></strong><span></span>
                            </div>
                            <div class="divresultthedt">
                                <table id="thedttblcardinfo" class="no-border" style="display:none !important;">
                                    <thead class="no-border">
                                        <tr>
                                            <th class="text-center">Loại thẻ</th>
                                            <th class="text-center">Mệnh giá</th>
                                            <th class="text-center">Mã số thẻ</th>
                                            <th class="text-center">Số serial thẻ</th>
                                        </tr>
                                    </thead>
                                    <tbody class="no-border-y"></tbody>
                                </table>
                                <div style="padding-top: 20px;"><span>Thời gian giao dịch: <span class="datetransaction"></span></span></div>
                                <span id="xuatexel" class="btn btn-green">Chi tiết mã thẻ</span>
                            </div>

                        </div>

                        <div class="modalbottom">
                            <button type="button" class="btn btn-primary" id="ctrcontinuebtn" data-dismiss="modal" tabindex="1"><i class="fa fa-sign-in"></i> Thoát</button>

                            <a href="/thong-bao-mua-tcoin" rel="nofollow" type="button" class="btn btn-success charge_money"><i class="fa fa-money"></i> Nạp tiền vào tài khoản</a>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <script type="text/javascript">
        $(function() {
            $("#thedtpreviewmodal").hide();
            $('#ctrlmuathedtbtn').show();
            $('.ctrlmuathedtemail').hide();
            $("#thongtingiaodich").show();
            $('.boxdrpmega #thedtPaymentMethod').each(function() {
                $(this).change(function() {

                    $($('#thedtPaymentMethod')).tooltip('hide').attr('data-original-title', '').removeClass('errorClass');
                    var thanhtoan = $(this).val();
                    if (thanhtoan == "BANTHE24H" || thanhtoan == '') {
                        $('.ctrlmuathedtemail').hide();

                    } else {
                        $('.ctrlmuathedtemail').show();

                    }
                });
            });
            $("#ProviderIdDT").change(function() {
                var _provider = $("#ProviderIdDT").val();
                if (_provider != '') {
                    loadcardtype($(this).val());
                }
            });
            $("#ctrlhuygiaodich").on("click", function() {
                $("#thedtpreviewmodal").hide();
                $('#ctrlsoluongthedt').val('');
                $('#ctrlmuathedtbtn').show();
                $("#thongtingiaodich").show();
            });
            $('#ctrlmuathedtbtn').on("click", function() {
                if (validatethedt()) {
                    $("#thongtingiaodich").hide();
                    $("#lblsoluongthe").text($('#ctrlsoluongthedt').val());
                    $("#lblsoluongthe").attr('style', 'color:#ff0000;');
                    $("#lblemail").text($('#ctrlmuathedtemail').val());
                    $("#lblemail").attr('style', 'color:#ff0000;');
                    if ($('#thedtPaymentMethod').val() == 'BANTHE24H') {
                        $(".thongtinemailnhan").hide();

                    } else {
                        $(".thongtinemailnhan").show();
                    }
                    var _amount = $("#optCardAmount").val();
                    var _arr = _amount.split('-');
                    var sumAmount = parseInt($("#optCardAmount").val()) * parseInt($("#ctrlsoluongthedt").val());
                    var telco = parseInt($('#ProviderIdDT').val());
                    var _pro_text = $("#ProviderIdDT option:selected").text();
                    $("#lblprovider").text(_pro_text);
                    $("#lblprovider").attr('style', 'color:#ff0000;');
                    $("#lblcardtype").text(parseInt(_amount).toLocaleString('en-US', {
                        minimumFractionDigits: 0
                    }) + " đ");
                    $("#lblcardtype").attr('style', 'color:#ff0000;');
                    var chietkhau = sumAmount;
                    switch (telco) {
                        case 5:
                        case 12:
                        case 13:
                        case 14:
                        case 17:
                            chietkhau = 0.965;
                            break;

                        case 23:
                            chietkhau = 0.925;
                            break;
                        case 24:
                        case 25:
                        case 26:
                            chietkhau = 0.86;
                            break;
                    }
                    if (parseInt(_amount) < 50000 && (parseInt(_amount) == 10000 || parseInt(_amount) == 20000 || parseInt(_amount) == 30000)) {
                        chietkhau = chietkhau + 0.03;
                    }
                    sumPrice = sumAmount * chietkhau;
                    $("#lblsotien").text(sumPrice.toLocaleString('en-US', {
                        minimumFractionDigits: 0
                    }) + " đ, giảm " + (sumAmount - sumPrice).toLocaleString('en-US', {
                        minimumFractionDigits: 0
                    }) + " đ");
                    $("#lblsotien").attr('style', 'color:#ff0000;');
                    if ($('#thedtPaymentMethod').val() == 'BANTHE24H') {
                        $.ajax({
                            url: "/user/CheckIfSessionValid",
                            type: "POST",
                            dataType: 'json',
                            success: function(result) {
                                if (result.Success == false) {
                                    $('#thedtpreviewmodal').show();
                                    $("#myModalLabelthedt").html("<b style='color:#ff0000;'>Bạn vui lòng đăng nhập hệ thống để giao dịch<br/> Nếu chưa có tài khoản quý khách vui lòng đăng ký tại banthe24h.vn</b>");
                                    $('#ctrthanhtoanthedt').hide();
                                } else {
                                    $('#ctrlmuathedtbtn').hide();
                                    $('#thedtpreviewmodal').show();
                                }
                            }
                        });
                    } else {
                        $("#Confirm_OrderDetail").hide();
                        $('#thedtpreviewmodal').show();
                        $('#ctrthanhtoanthedt').show();
                        $("#myModalLabelthedt").html("<b style='color:#ff0000'>Thanh toán ngay</b>");

                        $('#lblpttt').text('Ngân hàng thanh toán: ');
                    }


                    $('#divnotifybc span').text('');
                    $('#divnotifybc').hide();
                    $('#ctrlemailtxt_log').val('');
                    $('#ctrlpasstxt_log').val('');
                }
            });
            $('#ctrthanhtoanthedt').on("click", function() {
                var isVisible = $('#Confirm_OrderDetail').is(':visible');
                if ($('#thedtPaymentMethod').val() == 'BANTHE24H') {
                    $('#thedtpreviewmodal').show();
                    var _amount = $('#optCardAmount').val();

                    $.ajax({
                        url: "/user/PaymentBuyCardHasLogin",
                        type: 'POST',
                        data: {
                            providerId: $('#ProviderIdDT').val(),
                            amount: _amount,
                            quantity: $("#ctrlsoluongthedt").val(),
                            emailnhan: ""
                        },
                        dataType: 'json',
                        beforeSend: function() {
                            $("#boxLoading").show();
                        },
                        success: function(obj) {
                            $('#thedtshowresultmodal').modal({
                                backdrop: 'static',
                                keyboard: false
                            });

                            if (obj.Success == true) {
                                if (obj.data.errorCode != 00) {
                                    $('#thedttblcardinfo').hide();
                                    $('.divresultthedt').hide();
                                    $("#notifyresult").addClass('alert-warning');
                                    $('#notifyresult i').addClass('fa-times-circle');
                                    $('#notifyresult strong').text(' Lỗi giao dịch: ');
                                    $('#notifyresult span').text(obj.data.message + ' ' + obj.data.errorCode);
                                } else {
                                    $("#notifyresult").addClass('alert-success');
                                    $('#notifyresult i').addClass('fa-check');
                                    $('#notifyresult strong').text(' Thành công ');
                                    $('#notifyresult span').text("Quý khách vui lòng kiểm tra email để lấy thông tin thẻ cào");
                                    var rspListCard = jQuery.parseJSON(obj.data.listCards);
                                    /*for (var i = 0; i < rspListCard.length; i++) {
                                        $('#thedttblcardinfo tbody').append('<tr><td class="text-center">' + rspListCard[i].ProviderCode + '</td><td class="text-center">' + rspListCard[i].Amount + '</td><td class="text-center">' + "'" + rspListCard[i].PinCode + '</td><td class="text-center">' + "'" + rspListCard[i].Serial + '</td></tr>');
                                    }*/
                                    $('#thedttblcardinfo').hide();

                                    $('.divresultthedt').show();
                                }
                            } else {
                                $('.divresultthedt').hide();
                                $("#notifyresult").addClass('alert-warning');
                                $('#notifyresult i').addClass('fa-times-circle');
                                $('#notifyresult strong').text(' Có lỗi xảy ra! ' + obj.msg);
                                $('#buycardtblcardinfo').hide();
                            }
                        },
                        error: function(obj) {
                            alert('Có lỗi xảy ra. Vui lòng thử lại sau!');
                        },
                        complete: function() {
                            $("#boxLoading").hide();
                        }
                    });

                } else {

                    thanhtoanbank($('#thedtPaymentMethod').val(), $('#ProviderIdDT').val(), $('#ctrlmuathedtemail').val(), $('#optCardAmount').val(), $('#ctrlsoluongthedt').val());
                }
            });

            function thanhtoanbank(bankCode, providerId, email, amount, quantity) {
                $.ajax({
                    url: "/user/PaymentBuyCardUsesBank",
                    type: 'POST',
                    data: {
                        bankCode: bankCode,
                        providerId: providerId,
                        email: email,
                        amount: amount,
                        quantity: quantity
                    },
                    dataType: 'json',
                    beforeSend: function() {
                        $("#boxLoading").show();
                    },
                    success: function(obj) {
                        $('#thedtshowresultmodal').modal({
                            backdrop: 'static',
                            keyboard: false
                        });

                        if (obj.Success == true) {
                            if (obj.Signature == true) {
                                window.location.href = obj.data;
                            } else {
                                $('#thedttblcardinfo').hide();
                                $('.divresultthedt').hide();
                                $("#notifyresult").addClass('alert-warning');
                                $('#notifyresult i').addClass('fa-times-circle');
                                $('#notifyresult strong').text('Lỗi giao dịch: ');
                                $('#notifyresult span').text(obj.data.Message + ' ' + obj.data.RspCode);
                            }
                        } else {
                            $('.divresultthedt').hide();
                            $("#notifyresult").addClass('alert-warning');
                            $('#notifyresult i').addClass('fa-times-circle');
                            $('#notifyresult strong').text('Nhà mạng đang bảo trì! ');
                            $('#tblcardinfo').hide();
                        }
                    },
                    error: function(obj) {
                        alert('Có lỗi xảy ra. Vui lòng thử lại sau!');
                    },
                    complete: function() {
                        $("#boxLoading").hide();
                    }
                });
            };

            function loadcardtype(provider) {
                $.ajax({
                    url: "/user/GetListCardTypeByProviderId",
                    type: 'get',
                    data: {
                        PrividerId: provider
                    },
                    dataType: 'json',

                    success: function(obj) {
                        if (obj.Success == true) {

                            var strHTML = "";

                            strHTML = strHTML + "<select id='optCardAmount' class='form-control'>";
                            strHTML = strHTML + "<option value='0'>Mệnh giá thẻ nạp</option>";
                            for (var i = 0; i < obj.data.length; i++) {
                                strHTML = strHTML + "<option value='" + obj.data[i].Amount + "'>" + obj.data[i].CardName + "</option>";
                            }
                            strHTML = strHTML + "</select>";

                            $("#optCardAmount").remove();
                            $("#tbl_CardAmount").html(strHTML);





                        }
                    },
                    error: function(obj) {
                        alert('lỗi khi load mệnh giá thẻ!');
                    },
                    complete: function() {

                    }
                });
            };

            function validatethedt() {
                var flag = true;
                var thanhtoan = $('#thedtPaymentMethod').val();
                if ($.trim(thanhtoan) == '') {
                    $($('#thedtPaymentMethod')).tooltip('hide').attr('title', 'Chọn nhà cung cấp').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                } else {
                    $('#thedtPaymentMethod').data("title", "").removeClass("errorClass").tooltip("destroy");
                }


                var provider = $('#ProviderIdDT').val();
                if ($.trim(provider) == '') {
                    $($('#ProviderIdDT')).tooltip('hide').attr('title', 'Chọn nhà cung cấp').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                } else {
                    $('#ProviderIdDT').data("title", "").removeClass("errorClass").tooltip("destroy");
                }

                var cardamount = $('#optCardAmount').val();
                if ($('#optCardAmount').find(':selected').val() == "0") {
                    $($('#optCardAmount')).tooltip('hide').attr('title', 'Chọn mệnh giá thẻ').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                } else {
                    $('#optCardAmount').data("title", "").removeClass("errorClass").tooltip("destroy");
                }

                var slthe = $('#ctrlsoluongthedt').val();
                if ($.trim(slthe) == '' || $.trim(slthe) == 0) {
                    $($('#ctrlsoluongthedt')).tooltip('hide').attr('title', 'Nhập số lượng thẻ cần mua').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                } else {
                    $('#ctrlsoluongthedt').data("title", "").removeClass("errorClass").tooltip("destroy");
                }
                var letter = /^[0-9]+$/;
                if (!slthe.match(letter)) {
                    $($('#ctrlsoluongthedt')).tooltip('hide').attr('title', 'Bạn phải nhập dạng số').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                }

                var email1 = $('#ctrlmuathedtemail').val();
                var email1 = $('#ctrlmuathedtemail').val();
                if ($.trim(email1) == '' && thanhtoan != "BANTHE24H") {
                    $($('#ctrlmuathedtemail')).tooltip('hide').attr('data-original-title', 'Email không hợp lệ').tooltip('fixTitle').addClass('errorClass');
                    flag = false;
                }
                if ($.trim(email1) != '') {
                    if (!Common.IsValidEmail(email1)) {
                        $($('#ctrlmuathedtemail')).tooltip('hide').attr('data-original-title', 'Email không hợp lệ').tooltip('fixTitle').addClass('errorClass');
                        flag = false;
                    } else {
                        $('#ctrlmuathedtemail').data("title", "").removeClass("errorClass").tooltip("destroy");
                    }
                }

                return flag;
            };
        });
    </script>
</body>

</html>