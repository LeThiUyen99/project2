(function(d){var js,id='facebook-jssdk',ref=d.getElementsByTagName('script')[0];if(d.getElementById(id)){return;}js=d.createElement('script');js.id=id;js.async=true;js.src="//connect.facebook.net/en_US/all.js";ref.parentNode.insertBefore(js,ref);}(document));window.fbAsyncInit=function(){FB.init({appId:'1653929791486588',status:true,cookie:true,xfbml:true});var permissions=['email'].join(',');var fields=['name','email'].join(',');function showDetails(tokenstring){FB.api('/me',{fields:fields},function(details){var _adata={EmailAddress:details.email,FullName:details.name,AccessToken:tokenstring};var adata=JSON.stringify({accountentity:_adata});debugger;$.ajax({url:"/User/getuserloginface",type:'POST',data:_adata,dataType:'json',beforeSend:function(){$("#boxLoading").show();},success:function(obj){if(obj.Success==true){var url='/';window.location.href=url;}else{window.location.href='loginfacebook';}},error:function(obj){alert('Có lỗi xảy ra. Vui lòng thử lại sau!');},complete:function(){$("#boxLoading").hide();}});});}$('#loginfacebook').click(function(){FB.login(function(response){if(response.authResponse){showDetails(response.authResponse.accessToken);}},{scope:permissions});});};